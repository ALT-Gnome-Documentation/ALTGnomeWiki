"use strict";function a(k,b){return k.substring(0,b.length)===b}const m=(k,b)=>{const{ruleName:n="condition",ifMarker:p="::if",elseIfMarker:x="::elseif",elseMarker:t="::else",endIfMarker:_="::endif",validate:$=e=>!0,evaluate:g=(e,f)=>{let l=f;return e.split(".").forEach(u=>{l=l[u]}),!!l}}=b||{};k.block.ruler.before("fence",`${n}_block`,(e,f,l,u)=>{let r,i,h=e.bMarks[f]+e.tShift[f],M=e.eMarks[f],s,o=e.src.substring(h,M);if(a(o,p))s=o.substring(p.length+1);else return!1;if(!$(s))return!1;if(u)return!0;r=f,i=e.push(`${n}_if`,"",1),i.info=s,i.map=[f,r],i.hidden=!0;let c=r,d=e.lineMax;for(;r++,!(r>=l);)if(h=e.bMarks[r]+e.tShift[r],M=e.eMarks[r],o=e.src.substring(h,M),a(o,x))e.lineMax=r,e.md.block.tokenize(e,c+1,r),s=o.substring(x.length+1),i=e.push(`${n}_elseif`,"",1),i.block=!0,i.info=s,i.map=[r,r],i.hidden=!0,c=r,e.lineMax=d;else if(a(o,t))e.lineMax=r,e.md.block.tokenize(e,c+1,r),i=e.push(`${n}_else`,"",1),i.block=!0,i.map=[r,r],i.hidden=!0,c=r,e.lineMax=d;else if(a(o,_)){e.lineMax=r,e.md.block.tokenize(e,c+1,r),i=e.push(`${n}_endif`,"",1),i.block=!0,i.map=[r,r],i.hidden=!0,c=r,e.lineMax=d;break}return e.line=r+1,e.lineMax=d+1,!0}),k.core.ruler.push(`${n}_evaluate`,({tokens:e,env:f})=>{let l=!1,u=!1;for(let r=0;r<e.length;r++){const i=e[r];switch(i.type){case`${n}_if`:u=g(i.info,f),l=!u;break;case`${n}_elseif`:u?l=!0:(u=g(i.info,f),l=!u);break;case`${n}_else`:l=u;break;case`${n}_endif`:l=!1;break;default:l&&(e.splice(r,1),r--);break}}return!1})};module.exports=m;
